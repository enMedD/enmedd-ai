"""Cascade All

Revision ID: f7beb96d150d
Revises: 995760926721
Create Date: 2024-11-20 20:51:45.603668

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = "f7beb96d150d"
down_revision = "995760926721"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(
        "assistant__document_set_document_set_id_fkey",
        "assistant__document_set",
        type_="foreignkey",
    )
    op.drop_constraint(
        "assistant__document_set_assistant_id_fkey",
        "assistant__document_set",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__document_set_assistant_id_fkey",
        "assistant__document_set",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "assistant__document_set_document_set_id_fkey",
        "assistant__document_set",
        "document_set",
        ["document_set_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "assistant__prompt_prompt_id_fkey",
        "assistant__prompt",
        type_="foreignkey",
    )
    op.drop_constraint(
        "assistant__prompt_assistant_id_fkey",
        "assistant__prompt",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__prompt_prompt_id_fkey",
        "assistant__prompt",
        "prompt",
        ["prompt_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "assistant__prompt_assistant_id_fkey",
        "assistant__prompt",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "assistant__teamspace_assistant_id_fkey",
        "assistant__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "assistant__teamspace_teamspace_id_fkey",
        "assistant__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__teamspace_teamspace_id_fkey",
        "assistant__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "assistant__teamspace_assistant_id_fkey",
        "assistant__teamspace",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "assistant__tool_tool_id_fkey", "assistant__tool", type_="foreignkey"
    )
    op.drop_constraint(
        "assistant__tool_assistant_id_fkey",
        "assistant__tool",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__tool_tool_id_fkey",
        "assistant__tool",
        "tool",
        ["tool_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "assistant__tool_assistant_id_fkey",
        "assistant__tool",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "assistant__user_assistant_id_fkey",
        "assistant__user",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__user_assistant_id_fkey",
        "assistant__user",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "chat_folder__teamspace_chat_folder_id_fkey",
        "chat_folder__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_folder__teamspace_teamspace_id_fkey",
        "chat_folder__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_folder__teamspace_chat_folder_id_fkey",
        "chat_folder__teamspace",
        "chat_folder",
        ["chat_folder_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "chat_folder__teamspace_teamspace_id_fkey",
        "chat_folder__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint("fk_chat_message_assistant", "chat_message", type_="foreignkey")
    op.drop_constraint(
        "chat_message_chat_session_id_fkey", "chat_message", type_="foreignkey"
    )
    op.create_foreign_key(
        "chat_message_chat_session_id_fkey",
        "chat_message",
        "chat_session",
        ["chat_session_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "fk_chat_message_assistant",
        "chat_message",
        "assistant",
        ["alternate_assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "chat_message__search_doc_chat_message_id_fkey",
        "chat_message__search_doc",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_message__search_doc_search_doc_id_fkey",
        "chat_message__search_doc",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_message__search_doc_search_doc_id_fkey",
        "chat_message__search_doc",
        "search_doc",
        ["search_doc_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "chat_message__search_doc_chat_message_id_fkey",
        "chat_message__search_doc",
        "chat_message",
        ["chat_message_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "chat_session_chat_folder_fk", "chat_session", type_="foreignkey"
    )
    op.drop_constraint(
        "fk_chat_session_assistant_id", "chat_session", type_="foreignkey"
    )
    op.create_foreign_key(
        "fk_chat_session_assistant_id",
        "chat_session",
        "assistant",
        ["assistant_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "chat_session_chat_folder_fk",
        "chat_session",
        "chat_folder",
        ["folder_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "chat_session__teamspace_chat_session_id_fkey",
        "chat_session__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_session__teamspace_teamspace_id_fkey",
        "chat_session__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_session__teamspace_teamspace_id_fkey",
        "chat_session__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "chat_session__teamspace_chat_session_id_fkey",
        "chat_session__teamspace",
        "chat_session",
        ["chat_session_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "connector_credential_pair_connector_id_fkey",
        "connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "connector_credential_pair_credential_id_fkey",
        "connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "connector_credential_pair_credential_id_fkey",
        "connector_credential_pair",
        "credential",
        ["credential_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "connector_credential_pair_connector_id_fkey",
        "connector_credential_pair",
        "connector",
        ["connector_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_column("connector_credential_pair", "last_pruned")
    op.drop_constraint(
        "credential__teamspace_credential_id_fkey",
        "credential__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "credential__teamspace_teamspace_id_fkey",
        "credential__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "credential__teamspace_teamspace_id_fkey",
        "credential__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "credential__teamspace_credential_id_fkey",
        "credential__teamspace",
        "credential",
        ["credential_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "document_by_connector_credential_pair_credential_id_fkey",
        "document_by_connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_by_connector_credential_pair_connector_id_fkey",
        "document_by_connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_by_connector_credential_pair_connector_id_fkey",
        "document_by_connector_credential_pair",
        "connector",
        ["connector_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "document_by_connector_credential_pair_credential_id_fkey",
        "document_by_connector_credential_pair",
        "credential",
        ["credential_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "document_set__connector_credential_pair_document_set_id_fkey",
        "document_set__connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_set__connector_crede_connector_credential_pair_id_fkey",
        "document_set__connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__connector_crede_connector_credential_pair_id_fkey",
        "document_set__connector_credential_pair",
        "connector_credential_pair",
        ["connector_credential_pair_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "document_set__connector_credential_pair_document_set_id_fkey",
        "document_set__connector_credential_pair",
        "document_set",
        ["document_set_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "document_set__teamspace_document_set_id_fkey",
        "document_set__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_set__teamspace_teamspace_id_fkey",
        "document_set__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__teamspace_document_set_id_fkey",
        "document_set__teamspace",
        "document_set",
        ["document_set_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "document_set__teamspace_teamspace_id_fkey",
        "document_set__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "document_set__user_document_set_id_fkey",
        "document_set__user",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__user_document_set_id_fkey",
        "document_set__user",
        "document_set",
        ["document_set_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "fk_index_attempt_search_settings", "index_attempt", type_="foreignkey"
    )
    op.drop_constraint(
        "fk_index_attempt_connector_credential_pair_id",
        "index_attempt",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "fk_index_attempt_connector_credential_pair_id",
        "index_attempt",
        "connector_credential_pair",
        ["connector_credential_pair_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "fk_index_attempt_search_settings",
        "index_attempt",
        "search_settings",
        ["search_settings_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "index_attempt_errors_index_attempt_id_fkey",
        "index_attempt_errors",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "index_attempt_errors_index_attempt_id_fkey",
        "index_attempt_errors",
        "index_attempt",
        ["index_attempt_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "inputprompt__user_input_prompt_id_fkey",
        "inputprompt__user",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "inputprompt__user_input_prompt_id_fkey",
        "inputprompt__user",
        "inputprompt",
        ["input_prompt_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "llm_provider__teamspace_llm_provider_id_fkey",
        "llm_provider__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "llm_provider__teamspace_teamspace_id_fkey",
        "llm_provider__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "llm_provider__teamspace_teamspace_id_fkey",
        "llm_provider__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "llm_provider__teamspace_llm_provider_id_fkey",
        "llm_provider__teamspace",
        "llm_provider",
        ["llm_provider_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "standard_answer__standard_answer_catego_standard_answer_id_fkey",
        "standard_answer__standard_answer_category",
        type_="foreignkey",
    )
    op.drop_constraint(
        "standard_answer__standard_answ_standard_answer_category_id_fkey",
        "standard_answer__standard_answer_category",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "standard_answer__standard_answ_standard_answer_category_id_fkey",
        "standard_answer__standard_answer_category",
        "standard_answer_category",
        ["standard_answer_category_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "standard_answer__standard_answer_catego_standard_answer_id_fkey",
        "standard_answer__standard_answer_category",
        "standard_answer",
        ["standard_answer_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "teamspace__connector_credential_pair_cc_pair_id_fkey",
        "teamspace__connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "teamspace__connector_credential_pair_teamspace_id_fkey",
        "teamspace__connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "teamspace__connector_credential_pair_teamspace_id_fkey",
        "teamspace__connector_credential_pair",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "teamspace__connector_credential_pair_cc_pair_id_fkey",
        "teamspace__connector_credential_pair",
        "connector_credential_pair",
        ["cc_pair_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "teamspace_settings_teamspace_id_fkey",
        "teamspace_settings",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "teamspace_settings_teamspace_id_fkey",
        "teamspace_settings",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "token_rate_limit__teamspace_teamspace_id_fkey",
        "token_rate_limit__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "token_rate_limit__teamspace_rate_limit_id_fkey",
        "token_rate_limit__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "token_rate_limit__teamspace_rate_limit_id_fkey",
        "token_rate_limit__teamspace",
        "token_rate_limit",
        ["rate_limit_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "token_rate_limit__teamspace_teamspace_id_fkey",
        "token_rate_limit__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "tool__teamspace_tool_id_fkey", "tool__teamspace", type_="foreignkey"
    )
    op.drop_constraint(
        "tool__teamspace_teamspace_id_fkey",
        "tool__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "tool__teamspace_teamspace_id_fkey",
        "tool__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "tool__teamspace_tool_id_fkey",
        "tool__teamspace",
        "tool",
        ["tool_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "usage_report__teamspace_teamspace_id_fkey",
        "usage_report__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "usage_report__teamspace_report_id_fkey",
        "usage_report__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "usage_report__teamspace_teamspace_id_fkey",
        "usage_report__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "usage_report__teamspace_report_id_fkey",
        "usage_report__teamspace",
        "usage_reports",
        ["report_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "user__external_teamspace_id_cc_pair_id_fkey",
        "user__external_teamspace_id",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "user__external_teamspace_id_cc_pair_id_fkey",
        "user__external_teamspace_id",
        "connector_credential_pair",
        ["cc_pair_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "user__teamspace_teamspace_id_fkey",
        "user__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "user__teamspace_teamspace_id_fkey",
        "user__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint("workspace_instance_id_fkey", "workspace", type_="foreignkey")
    op.create_foreign_key(
        "workspace_instance_id_fkey",
        "workspace",
        "instance",
        ["instance_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "workspace__teamspace_workspace_id_fkey",
        "workspace__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "workspace__teamspace_teamspace_id_fkey",
        "workspace__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "workspace__teamspace_workspace_id_fkey",
        "workspace__teamspace",
        "workspace",
        ["workspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "workspace__teamspace_teamspace_id_fkey",
        "workspace__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "workspace__users_workspace_id_fkey",
        "workspace__users",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "workspace__users_workspace_id_fkey",
        "workspace__users",
        "workspace",
        ["workspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    op.drop_constraint(
        "workspace_settings_workspace_id_fkey",
        "workspace_settings",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "workspace_settings_workspace_id_fkey",
        "workspace_settings",
        "workspace",
        ["workspace_id"],
        ["id"],
        ondelete="CASCADE",
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(
        "workspace_settings_workspace_id_fkey", "workspace_settings", type_="foreignkey"
    )
    op.create_foreign_key(
        "workspace_settings_workspace_id_fkey",
        "workspace_settings",
        "workspace",
        ["workspace_id"],
        ["id"],
    )
    op.drop_constraint(
        "workspace__users_workspace_id_fkey", "workspace__users", type_="foreignkey"
    )
    op.create_foreign_key(
        "workspace__users_workspace_id_fkey",
        "workspace__users",
        "workspace",
        ["workspace_id"],
        ["id"],
    )
    op.drop_constraint(
        "workspace__teamspace_teamspace_id_fkey",
        "workspace__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "workspace__teamspace_workspace_id_fkey",
        "workspace__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "workspace__teamspace_teamspace_id_fkey",
        "workspace__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "workspace__teamspace_workspace_id_fkey",
        "workspace__teamspace",
        "workspace",
        ["workspace_id"],
        ["id"],
    )
    op.drop_constraint("workspace_instance_id_fkey", "workspace", type_="foreignkey")
    op.create_foreign_key(
        "workspace_instance_id_fkey",
        "workspace",
        "instance",
        ["instance_id"],
        ["id"],
    )
    op.drop_constraint(
        "user__teamspace_teamspace_id_fkey", "user__teamspace", type_="foreignkey"
    )
    op.create_foreign_key(
        "user__teamspace_teamspace_id_fkey",
        "user__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.drop_constraint(
        "user__external_teamspace_id_cc_pair_id_fkey",
        "user__external_teamspace_id",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "user__external_teamspace_id_cc_pair_id_fkey",
        "user__external_teamspace_id",
        "connector_credential_pair",
        ["cc_pair_id"],
        ["id"],
    )
    op.drop_constraint(
        "usage_report__teamspace_report_id_fkey",
        "usage_report__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "usage_report__teamspace_teamspace_id_fkey",
        "usage_report__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "usage_report__teamspace_report_id_fkey",
        "usage_report__teamspace",
        "usage_reports",
        ["report_id"],
        ["id"],
    )
    op.create_foreign_key(
        "usage_report__teamspace_teamspace_id_fkey",
        "usage_report__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.drop_constraint(
        "tool__teamspace_teamspace_id_fkey", "tool__teamspace", type_="foreignkey"
    )
    op.drop_constraint(
        "tool__teamspace_tool_id_fkey", "tool__teamspace", type_="foreignkey"
    )
    op.create_foreign_key(
        "tool__teamspace_teamspace_id_fkey",
        "tool__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "tool__teamspace_tool_id_fkey",
        "tool__teamspace",
        "tool",
        ["tool_id"],
        ["id"],
    )
    op.drop_constraint(
        "token_rate_limit__teamspace_rate_limit_id_fkey",
        "token_rate_limit__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "token_rate_limit__teamspace_teamspace_id_fkey",
        "token_rate_limit__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "token_rate_limit__teamspace_rate_limit_id_fkey",
        "token_rate_limit__teamspace",
        "token_rate_limit",
        ["rate_limit_id"],
        ["id"],
    )
    op.create_foreign_key(
        "token_rate_limit__teamspace_teamspace_id_fkey",
        "token_rate_limit__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.drop_constraint(
        "teamspace_settings_teamspace_id_fkey", "teamspace_settings", type_="foreignkey"
    )
    op.create_foreign_key(
        "teamspace_settings_teamspace_id_fkey",
        "teamspace_settings",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.drop_constraint(None, "teamspace__connector_credential_pair", type_="foreignkey")
    op.drop_constraint(None, "teamspace__connector_credential_pair", type_="foreignkey")
    op.create_foreign_key(
        "teamspace__connector_credential_pair_teamspace_id_fkey",
        "teamspace__connector_credential_pair",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "teamspace__connector_credential_pair_cc_pair_id_fkey",
        "teamspace__connector_credential_pair",
        "connector_credential_pair",
        ["cc_pair_id"],
        ["id"],
    )
    op.drop_constraint(
        None, "standard_answer__standard_answer_category", type_="foreignkey"
    )
    op.drop_constraint(
        None, "standard_answer__standard_answer_category", type_="foreignkey"
    )
    op.create_foreign_key(
        "standard_answer__standard_answ_standard_answer_category_id_fkey",
        "standard_answer__standard_answer_category",
        "standard_answer_category",
        ["standard_answer_category_id"],
        ["id"],
    )
    op.create_foreign_key(
        "standard_answer__standard_answer_catego_standard_answer_id_fkey",
        "standard_answer__standard_answer_category",
        "standard_answer",
        ["standard_answer_id"],
        ["id"],
    )
    op.drop_constraint(
        "llm_provider__teamspace_teamspace_id_fkey",
        "llm_provider__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "llm_provider__teamspace_llm_provider_id_fkey",
        "llm_provider__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "llm_provider__teamspace_teamspace_id_fkey",
        "llm_provider__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "llm_provider__teamspace_llm_provider_id_fkey",
        "llm_provider__teamspace",
        "llm_provider",
        ["llm_provider_id"],
        ["id"],
    )
    op.drop_constraint(
        "inputprompt__user_input_prompt_id_fkey",
        "inputprompt__user",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "inputprompt__user_input_prompt_id_fkey",
        "inputprompt__user",
        "inputprompt",
        ["input_prompt_id"],
        ["id"],
    )
    op.drop_constraint(
        "index_attempt_errors_index_attempt_id_fkey",
        "index_attempt_errors",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "index_attempt_errors_index_attempt_id_fkey",
        "index_attempt_errors",
        "index_attempt",
        ["index_attempt_id"],
        ["id"],
    )
    op.drop_constraint(
        "fk_index_attempt_connector_credential_pair_id",
        "index_attempt",
        type_="foreignkey",
    )
    op.drop_constraint(
        "fk_index_attempt_search_settings", "index_attempt", type_="foreignkey"
    )
    op.create_foreign_key(
        "fk_index_attempt_connector_credential_pair_id",
        "index_attempt",
        "connector_credential_pair",
        ["connector_credential_pair_id"],
        ["id"],
    )
    op.create_foreign_key(
        "fk_index_attempt_search_settings",
        "index_attempt",
        "search_settings",
        ["search_settings_id"],
        ["id"],
    )
    op.drop_constraint(
        "document_set__user_document_set_id_fkey",
        "document_set__user",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__user_document_set_id_fkey",
        "document_set__user",
        "document_set",
        ["document_set_id"],
        ["id"],
    )
    op.drop_constraint(
        "document_set__teamspace_teamspace_id_fkey",
        "document_set__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_set__teamspace_document_set_id_fkey",
        "document_set__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__teamspace_teamspace_id_fkey",
        "document_set__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "document_set__teamspace_document_set_id_fkey",
        "document_set__teamspace",
        "document_set",
        ["document_set_id"],
        ["id"],
    )
    op.drop_constraint(
        "document_set__connector_crede_connector_credential_pair_id_fkey",
        "document_set__connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_set__connector_credential_pair_document_set_id_fkey",
        "document_set__connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_set__connector_crede_connector_credential_pair_id_fkey",
        "document_set__connector_credential_pair",
        "connector_credential_pair",
        ["connector_credential_pair_id"],
        ["id"],
    )
    op.create_foreign_key(
        "document_set__connector_credential_pair_document_set_id_fkey",
        "document_set__connector_credential_pair",
        "document_set",
        ["document_set_id"],
        ["id"],
    )
    op.drop_constraint(
        "document_by_connector_credential_pair_connector_id_fkey",
        "document_by_connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "document_by_connector_credential_pair_credential_id_fkey",
        "document_by_connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "document_by_connector_credential_pair_connector_id_fkey",
        "document_by_connector_credential_pair",
        "connector",
        ["connector_id"],
        ["id"],
    )
    op.create_foreign_key(
        "document_by_connector_credential_pair_credential_id_fkey",
        "document_by_connector_credential_pair",
        "credential",
        ["credential_id"],
        ["id"],
    )
    op.drop_constraint(
        "credential__teamspace_teamspace_id_fkey",
        "credential__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "credential__teamspace_credential_id_fkey",
        "credential__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "credential__teamspace_teamspace_id_fkey",
        "credential__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "credential__teamspace_credential_id_fkey",
        "credential__teamspace",
        "credential",
        ["credential_id"],
        ["id"],
    )
    op.add_column(
        "connector_credential_pair",
        sa.Column(
            "last_pruned",
            postgresql.TIMESTAMP(timezone=True),
            autoincrement=False,
            nullable=True,
        ),
    )
    op.drop_constraint(
        "connector_credential_pair_credential_id_fkey",
        "connector_credential_pair",
        type_="foreignkey",
    )
    op.drop_constraint(
        "connector_credential_pair_connector_id_fkey",
        "connector_credential_pair",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "connector_credential_pair_credential_id_fkey",
        "connector_credential_pair",
        "credential",
        ["credential_id"],
        ["id"],
    )
    op.create_foreign_key(
        "connector_credential_pair_connector_id_fkey",
        "connector_credential_pair",
        "connector",
        ["connector_id"],
        ["id"],
    )
    op.drop_constraint(
        "chat_session__teamspace_teamspace_id_fkey",
        "chat_session__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_session__teamspace_chat_session_id_fkey",
        "chat_session__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_session__teamspace_teamspace_id_fkey",
        "chat_session__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "chat_session__teamspace_chat_session_id_fkey",
        "chat_session__teamspace",
        "chat_session",
        ["chat_session_id"],
        ["id"],
    )
    op.drop_constraint(
        "fk_chat_session_assistant_id", "chat_session", type_="foreignkey"
    )
    op.drop_constraint(
        "chat_session_chat_folder_fk", "chat_session", type_="foreignkey"
    )
    op.create_foreign_key(
        "fk_chat_session_assistant_id",
        "chat_session",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.create_foreign_key(
        "chat_session_chat_folder_fk",
        "chat_session",
        "chat_folder",
        ["folder_id"],
        ["id"],
    )
    op.drop_constraint(
        "chat_message__search_doc_search_doc_id_fkey",
        "chat_message__search_doc",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_message__search_doc_chat_message_id_fkey",
        "chat_message__search_doc",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_message__search_doc_search_doc_id_fkey",
        "chat_message__search_doc",
        "search_doc",
        ["search_doc_id"],
        ["id"],
    )
    op.create_foreign_key(
        "chat_message__search_doc_chat_message_id_fkey",
        "chat_message__search_doc",
        "chat_message",
        ["chat_message_id"],
        ["id"],
    )
    op.drop_constraint(
        "chat_message_chat_session_id_fkey", "chat_message", type_="foreignkey"
    )
    op.drop_constraint("fk_chat_message_assistant", "chat_message", type_="foreignkey")
    op.create_foreign_key(
        "chat_message_chat_session_id_fkey",
        "chat_message",
        "chat_session",
        ["chat_session_id"],
        ["id"],
    )
    op.create_foreign_key(
        "fk_chat_message_assistant",
        "chat_message",
        "assistant",
        ["alternate_assistant_id"],
        ["id"],
    )
    op.create_unique_constraint("chat_message_id_key", "chat_message", ["id"])
    op.drop_constraint(
        "chat_folder__teamspace_teamspace_id_fkey",
        "chat_folder__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "chat_folder__teamspace_chat_folder_id_fkey",
        "chat_folder__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "chat_folder__teamspace_teamspace_id_fkey",
        "chat_folder__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "chat_folder__teamspace_chat_folder_id_fkey",
        "chat_folder__teamspace",
        "chat_folder",
        ["chat_folder_id"],
        ["id"],
    )
    op.drop_constraint(
        "assistant__user_assistant_id_fkey", "assistant__user", type_="foreignkey"
    )
    op.create_foreign_key(
        "assistant__user_assistant_id_fkey",
        "assistant__user",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.drop_constraint(
        "assistant__tool_assistant_id_fkey", "assistant__tool", type_="foreignkey"
    )
    op.drop_constraint(
        "assistant__tool_tool_id_fkey", "assistant__tool", type_="foreignkey"
    )
    op.create_foreign_key(
        "assistant__tool_assistant_id_fkey",
        "assistant__tool",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.create_foreign_key(
        "assistant__tool_tool_id_fkey",
        "assistant__tool",
        "tool",
        ["tool_id"],
        ["id"],
    )
    op.drop_constraint(
        "assistant__teamspace_teamspace_id_fkey",
        "assistant__teamspace",
        type_="foreignkey",
    )
    op.drop_constraint(
        "assistant__teamspace_assistant_id_fkey",
        "assistant__teamspace",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__teamspace_teamspace_id_fkey",
        "assistant__teamspace",
        "teamspace",
        ["teamspace_id"],
        ["id"],
    )
    op.create_foreign_key(
        "assistant__teamspace_assistant_id_fkey",
        "assistant__teamspace",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.drop_constraint(
        "assistant__prompt_assistant_id_fkey", "assistant__prompt", type_="foreignkey"
    )
    op.drop_constraint(
        "assistant__prompt_prompt_id_fkey", "assistant__prompt", type_="foreignkey"
    )
    op.create_foreign_key(
        "assistant__prompt_assistant_id_fkey",
        "assistant__prompt",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.create_foreign_key(
        "assistant__prompt_prompt_id_fkey",
        "assistant__prompt",
        "prompt",
        ["prompt_id"],
        ["id"],
    )
    op.drop_constraint(
        "assistant__document_set_assistant_id_fkey",
        "assistant__document_set",
        type_="foreignkey",
    )
    op.drop_constraint(
        "assistant__document_set_document_set_id_fkey",
        "assistant__document_set",
        type_="foreignkey",
    )
    op.create_foreign_key(
        "assistant__document_set_assistant_id_fkey",
        "assistant__document_set",
        "assistant",
        ["assistant_id"],
        ["id"],
    )
    op.create_foreign_key(
        "assistant__document_set_document_set_id_fkey",
        "assistant__document_set",
        "document_set",
        ["document_set_id"],
        ["id"],
    )
    # ### end Alembic commands ###
